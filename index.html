<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cold Storage Sentinel</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Cold Storage Sentinel</h1>
        </header>

        <main>
            <section class="card status-overview">
                <h2>Live Status</h2>
                <div class="status-grid">
                    <div>Temperature: <span id="temp-value">--</span> °C</div>
                    <div>Humidity: <span id="humidity-value">--</span> %</div>
                    <div>Fan Actual: <span id="fan-actual-status">--</span></div>
                    <div>Fan Control: <span id="fan-control-mode">AUTO</span></div>
                    <div>Last Update: <span id="last-update">--</span></div>
                </div>
                <div class="live-diagram">
                    <h3>System Diagram</h3>
                    <div class="component esp">ESP8266 <span class="status-dot" id="esp-dot"></span></div>
                    <div class="arrow esp-to-flask" id="arrow-esp-flask">→</div>
                    <div class="component flask">Flask Server <span class="status-dot" id="flask-dot"></span></div>
                    <div class="arrow flask-to-supabase" id="arrow-flask-supabase">→</div>
                    <div class="arrow flask-to-web" id="arrow-flask-web">←</div> <!-- Data from Flask to Web -->
                    <div class="arrow web-to-flask" id="arrow-web-flask">→</div> <!-- Control from Web to Flask -->
                    <div class="component supabase">Supabase DB <span class="status-dot" id="supabase-dot"></span></div>
                    <div class="component web">Website UI <span class="status-dot" id="web-dot"></span></div>
                </div>
            </section>

            <section class="card controls">
                <h2>Controls</h2>
                <div>
                    <label for="fan-threshold">Auto Fan Threshold (°C):</label>
                    <input type="number" id="fan-threshold" step="0.1" value="25.0">
                </div>
                <div>
                    <label for="rgb-brightness">RGB Brightness (0-255):</label>
                    <input type="number" id="rgb-brightness" min="0" max="255" step="1" value="50">
                </div>
                <button id="update-base-config-btn">Update Auto/RGB Config</button>
                <p id="base-config-message"></p>

                <div class="manual-fan-controls">
                    <h3>Manual Fan Control</h3>
                    <div class="switch-container">
                        <label for="manual-fan-mode-toggle" class="manual-mode-label">Manual Mode:</label>
                        <label class="switch">
                            <input type="checkbox" id="manual-fan-mode-toggle">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div id="manual-fan-buttons" style="display: none;"> <!-- Initially hidden -->
                        <button class="toggle-button" id="manual-fan-on-btn">Set Fan ON</button>
                        <button class="toggle-button" id="manual-fan-off-btn">Set Fan OFF</button>
                    </div>
                    <p id="manual-fan-message"></p>
                </div>
            </section>

            <section class="card charts">
                <h2>Historical Data</h2>
                <canvas id="tempHumidityChart"></canvas>
            </section>
        </main>

        <footer>
            <p>© 2023 Cold Storage Sentinel</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>